medical_emergency_system/
â”‚
â”œâ”€â”€ manage.py
â”œâ”€â”€ emergency_project/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ settings.py
â”‚   â”œâ”€â”€ urls.py
â”‚   â””â”€â”€ wsgi.py
â”œâ”€â”€templates/
â”‚   â”œâ”€â”€ base.html
â”‚   â””â”€â”€ home.html
â”‚
â”‚
â”œâ”€â”€ users/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ models.py
â”‚   â”œâ”€â”€ views.py
â”‚   â”œâ”€â”€ forms.py
â”‚   â”œâ”€â”€ urls.py
â”‚   â””â”€â”€ templates/
â”‚       â””â”€â”€ users/
â”‚           â”œâ”€â”€ login.html
â”‚           â”œâ”€â”€ register.html
â”‚           â””â”€â”€ profile.html
â”‚
â”œâ”€â”€ emergency/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ models.py
â”‚   â”œâ”€â”€ views.py
â”‚   â”œâ”€â”€ forms.py
â”‚   â”œâ”€â”€ urls.py
â”‚   â””â”€â”€ templates/
â”‚       â””â”€â”€ emergency/
â”‚           â”œâ”€â”€ request_help.html
â”‚           â”œâ”€â”€ hospitals_list.html
|           â”œâ”€â”€ delete_patient.html
|           â”œâ”€â”€ edit_patient.html
â”‚           â””â”€â”€ patients_details.html
â”‚
â”œâ”€â”€ medical_records/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ models.py
â”‚   â”œâ”€â”€ views.py
â”‚   â”œâ”€â”€ forms.py
â”‚   â”œâ”€â”€ urls.py
â”‚   â””â”€â”€ templates/
â”‚       â””â”€â”€ medical_records/
â”‚           â”œâ”€â”€ delete_record.html
â”‚           â”œâ”€â”€ edit_record.html
â”‚           â”œâ”€â”€ upload_record.html
â”‚           â””â”€â”€ view_records.html
â”‚
â”œâ”€â”€ chat/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ models.py
â”‚   â”œâ”€â”€ views.py
â”‚   â”œâ”€â”€ consumers.py
â”‚   â”œâ”€â”€ routing.py
â”‚   â””â”€â”€ templates/
â”‚       â””â”€â”€ chat/
â”‚           â”œâ”€â”€ doctor_chat.html
â”‚           â””â”€â”€ video_consultation.html
â”œâ”€â”€ static/
â”‚   â””â”€â”€ css/
|       â”œâ”€â”€ doctor_chat.css
|       â”œâ”€â”€ home.css
|       â”œâ”€â”€ hospitals_list.css
|       â”œâ”€â”€ logout.css
|       â”œâ”€â”€ patients_details.css
|       â”œâ”€â”€ profile.css
|       â”œâ”€â”€ request_help.css
|       â”œâ”€â”€ upload_record.css
|       â”œâ”€â”€ style.css
|       â”œâ”€â”€ upload_record.css
|       â”œâ”€â”€ video_consultation.css
â”‚       â””â”€â”€ view_records.css
â”‚           
â”‚
â””â”€â”€ requirements.txt





















## install commands
    pip install Django django-crispy-forms channels channels-redis django-allauth python-dotenv django-leaflet geopy requests aiortc celery redis twilio reportlab Pillow qrcode scikit-learn pytest pytest-django gunicorn python-dateutil Pillow



ambulance_tracking.html
{% extends 'base.html' %}

{% block content %}
<h2>ğŸš¨ Track Nearest Ambulance</h2>
<p>ğŸ“ Live Ambulance Tracking</p>

<!-- Track Button -->
<button id="track-ambulance">ğŸš‘ Track Nearest Ambulance</button>

<!-- Map Section -->
<h2>ğŸ“ Live Ambulance Location</h2>
<div id="map-container">
    <div id="map"></div>
</div>

<p id="eta-info" style="color: green;"></p>
<p id="error-message" style="color: red;"></p>

<!-- LeafletJS for Maps -->
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
<script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>

<style>
    #map-container {
        width: 100%;
        display: flex;
        justify-content: flex-start;
        margin-top: 10px;
    }
    #map {
        width: 100%;
        height: 400px;
        border: 1px solid #ccc;
    }
    button {
        background-color: #007bff;
        color: white;
        padding: 10px;
        border: none;
        cursor: pointer;
    }
    button:hover {
        background-color: #0056b3;
    }
</style>

<script>
document.getElementById("track-ambulance").addEventListener("click", function () {
    if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(
            function (position) {
                let userLat = position.coords.latitude;
                let userLon = position.coords.longitude;
                trackAmbulance(userLat, userLon);
            },
            function () {
                document.getElementById("error-message").textContent = "âŒ Location access denied. Enable GPS.";
            }
        );
    } else {
        document.getElementById("error-message").textContent = "âŒ Geolocation is not supported in this browser.";
    }
});

let map;

function trackAmbulance(userLat, userLon) {
    fetch(`/emergency/nearest-ambulance/?lat=${userLat}&lon=${userLon}`)
        .then(response => response.json())
        .then(data => {
            if (data.error) {
                document.getElementById("error-message").textContent = `âš ï¸ ${data.error}`;
                return;
            }

            let { ambulance_lat, ambulance_lon, eta } = data;

            document.getElementById("eta-info").textContent = `ğŸš‘ Nearest ambulance is ${eta} minutes away.`;

            if (map) {
                map.remove();
            }
            map = L.map("map").setView([userLat, userLon], 13);
            L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png").addTo(map);

            // User Location Marker
            L.marker([userLat, userLon]).addTo(map).bindPopup("ğŸ“ Your Location").openPopup();

            // Ambulance Location Marker
            L.marker([ambulance_lat, ambulance_lon], {
                icon: L.icon({ iconUrl: 'https://img.icons8.com/color/48/ambulance.png', iconSize: [40, 40] })
            }).addTo(map).bindPopup("ğŸš‘ Nearest Ambulance").openPopup();
        })
        .catch(() => {
            document.getElementById("error-message").textContent = "âŒ Error fetching ambulance data.";
        });
}
</script>

{% endblock %}
